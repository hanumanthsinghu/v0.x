<!doctype html>
<html lang='en-GB'>
<head>
	<meta charset='utf-8'>
	<meta http-equiv='X-UA-Compatible' content='IE=Edge,chrome=1'>

	<title> References | Docs | Ractive.js </title >

	<meta name='viewport' content='width=device-width'>

	<link rel='icon' type='image/png' href='../assets/favicon.png'>
	<link rel='stylesheet' href='../min.css'>

	<!--[if lte IE 8]>
		<script src='../assets/respond.min.js'></script>
		<script src='../assets/html5shiv.min.js'></script>
	<![endif]-->

</head>

<body class='example'>

	<nav>
	<div class='nav-inner'>
		<a href='http://ractivejs.org'>Ractive.js</a>
		<a class='github-wide' href='https://github.com/ractivejs/ractive'>GitHub</a>
		<button id='nav-toggle'>&#9776;</button>
	</div>
</nav>


	<main>
		<div class='content'>
			<header class='main-header'>
				<h1>References</h1>
				<a class='edit-link' href='https://github.com/ractivejs/docs.ractivejs.org/edit/master/docs/0.8/References.md.hbs'>edit this page</a>
			</header>

			<p>Within this documentation, and within Ractive&#39;s code, a <em>reference</em> is a string that refers to a piece of data - in other words, within a <code>{{name}}</code> <a href="mustaches">mustache</a>, <code>name</code> is the reference.</p>
<p>By themselves, references are useless - they must <em>resolve</em> to a <em><a href="keypaths">keypath</a></em> before we can do anything with them (like render their value). If the reference exists with a section mustache, it may need to be resolved <em>in the context of that section</em>. In fact, because sections can be nested, we have to resolve each reference within its <em>context stack</em>.</p>
<p>The resolution algorithm looks like this:</p>
<ol>
<li>Is the reference a special ref? If so, resolve with the appropriate special keypath.</li>
<li>If the reference is explicit or matches a path in the current context exactly, resolve with that keypath.</li>
<li>Grab the current virtual node from the template hierarchy.</li>
<li>If there are any aliases, index, or key mapping defined that match, resolve with that keypath.</li>
<li>If this is a component and there are any matching mappings, resolve with that keypath.</li>
<li>If this node has context and there is a matching path, resolve with that keypath.</li>
<li>Otherwise, remove the innermost context from the stack. Repeat (3-7).</li>
<li>See if <code>reference</code> is a valid keypath by itself. If so, resolve with that keypath.</li>
<li>If the reference is still unresolved, add it to the &#39;pending resolution&#39; pile. Each time potentially matching keypaths are updated, resolution will be attempted for the unresolved reference.</li>
</ol>
<h2 id="huh-">Huh?</h2>
<p>That&#39;s a little bit abstract. The following example may help explain:</p>
<pre><code class="language-html">{{#user}}
  &lt;p&gt;Welcome back, {{name}}!
    {{#messages}}
      You have {{unread}} unread of {{total}} total messages.
      You last logged in on {{lastLogin}}.
    {{/messages}}
  &lt;/p&gt;
{{/user}}</code></pre>
<pre><code class="language-js">ractive = <span class="keyword">new</span> Ractive({
  el: container,
  template: myTemplate,
  data: {
    user: {
      name: <span class="string">'Jim'</span>,
      messages: {
        total: <span class="number">10</span>,
        unread: <span class="number">3</span>
      },
      lastLogin: <span class="string">'Wednesday'</span>
    }
  }
});</code></pre>
<p>We start with an empty context stack, so to resolve the <code>user</code> in <code>{{#user}}</code> we skip ahead to step 6 of the algorithm. Is <code>user</code> a valid keypath - i.e. does <code>ractive.data</code> have a <code>user</code> property? Why yes, it does.</p>
<p>Within the <code>{{#user}}</code> section, <code>user</code> is a context. So we now have a non-empty context stack - <code>[&#39;user&#39;]</code>. So when we come to resolve the <code>name</code> in <code>{{name}}</code>, we go to step 2. The innermost (and only) context is <code>user</code>, so we test the keypath <code>user.name</code>. Is it valid? Why yes, it is. So the <code>name</code> resolves to <code>user.name</code>.</p>
<p>Next up, <code>{{#messages}}</code>. The innermost context is still <code>user</code>, so we test <code>user.messages</code> - bingo. Because it&#39;s a section mustache, anything inside it now has a two-level context stack (<code>[&#39;user&#39;, &#39;user.messages&#39;]</code>).</p>
<p>We take <code>{{unread}}</code> and <code>{{total}}</code> and apply the same algorithm - sure enough, they resolve to <code>user.messages.unread</code> and <code>user.messages.total</code>.</p>
<p>What about <code>{{lastLogin}}</code>? Again, we take the innermost context from the stack - <code>user.messages</code>. Is <code>user.messages.lastLogin</code> a valid keypath? No, it isn&#39;t. So we take the next innermost context - <code>user</code>. As it turns out, <code>user.lastLogin</code> is a valid keypath, so the reference resolves.</p>
<p>Most of the time you don&#39;t need to be aware that this is going on, especially if you&#39;re already familiar with <a href="mustaches">Mustache</a>, but it&#39;s useful to have a background understanding.</p>
<h2 id="lists">Lists</h2>
<p>This is also how list sections work. Consider the following:</p>
<pre><code class="language-html">{{#items}}
  {{content}}
{{/items}}</code></pre>
<pre><code class="language-js">ractive = <span class="keyword">new</span> Ractive({
  el: container,
  template: myTemplate,
  data: {
    items: [{ content: <span class="string">'zero'</span> }, { content: <span class="string">'one'</span> }, { content: <span class="string">'two'</span> }]
  }
});</code></pre>
<p>The contents of the <code>{{#items}}</code> section are rendered once for each member of <code>items</code>. Each time round, the context changes - the first time it is <code>items.0</code>, then it is <code>items.1</code>, then it is <code>items.2</code>.</p>
<p>With a context of <code>items.0</code>, the <code>content</code> reference resolves to <code>items.0.content</code>, and so on.</p>
<h2 id="current-context-or-this-">Current context - <code>{{.}}</code> or <code>{{this}}</code></h2>
<p>Using <code>{{.}}</code> or <code>{{this}}</code> (they refer to the same thing) resolves to the current data context.</p>
<p>For example, sometimes you will have lists of primitives (i.e. strings and numbers) rather than objects. To refer to the primitives, we must use the <em>implicit iterator</em>:</p>
<pre><code class="language-html">{{#items}}
  {{.}}
{{/items}}</code></pre>
<pre><code class="language-js">ractive = <span class="keyword">new</span> Ractive({
  el: container,
  template: myTemplate,
  data: {
    items: [ <span class="string">'zero'</span>, <span class="string">'one'</span>, <span class="string">'two'</span> ]
  }
});</code></pre>
<p>Whenever Ractive sees <code>{{.}}</code>, it simply resolves it to the innermost context - <code>items.0</code>, <code>items.1</code>, <code>items.2</code>.</p>
<p>In Ractive (but not Mustache), you can use <code>{{this}}</code> in place of <code>{{.}}</code>. This is because in expressions - <code>{{this.toFixed(1)}}</code> looks much nicer than <code>{{..toFixed(1)}}</code> (for example).</p>
<h2 id="restricted-references">Restricted references</h2>
<p>Sometimes you may want to reference a property within the current context regardless of whether that property currently exists. For those situations you can use what&#39;s called a <em>restricted reference</em> (note that this feature does not exist in vanilla Mustache):</p>
<pre><code class="language-html">{{#options}}
  &lt;label&gt;&lt;input type=&#39;checkbox&#39; checked=&#39;{{.selected}}&#39;&gt; {{description}}&lt;/label&gt;
{{/options}}</code></pre>
<p>This feature is particularly useful with <a href="two-way-binding">two-way binding</a> as these references have to be resolved immediately.</p>
<p>You can also use the form <code>{{./selected}}</code> if you prefer, or <code>{{this.selected}}</code>, both of which are the same as <code>{{.selected}}</code>.</p>
<h3 id="ancestor-references">Ancestor references</h3>
<p>Very occasionally, you might need to refer explicitly to a property higher up in the tree to avoid naming conflicts. You can do that by prefixing references with <code>../</code> (or <code>../../</code>, or <code>../../../</code>...):</p>
<pre><code class="language-html">&lt;h1&gt;Blog posts by {{name}}&lt;/p&gt;

&lt;ul class=&#39;blog-posts&#39;&gt;
  {{#posts}}
    &lt;li&gt;&lt;a href=&#39;{{ slugify(../../name) }}/{{ slugify(name) }}&#39;&gt;{{name}}&lt;/a&gt;&lt;/li&gt;
  {{/posts}}
&lt;/ul&gt;</code></pre>
<pre><code class="language-js"><span class="keyword">var</span> ractive = <span class="keyword">new</span> Ractive({
  el: document.body,
  template: myTemplate,
  data: {
    name: <span class="string">'Rich'</span>,
    posts: [
      { name: <span class="string">'This is a blog post'</span> },
      { name: <span class="string">'And so is this'</span> }
    ],
    slugify: <span class="function"><span class="keyword">function</span> <span class="params">( str )</span> {</span>
      <span class="keyword">var</span> slug;
      <span class="comment">/* SOME CODE HAPPENS */</span>
      <span class="keyword">return</span> slug;
    }
  }
});</code></pre>
<p>In this example, some damn fool decided it would be a good idea to give posts a &#39;name&#39; property as well as authors. Which means that in the <code>href</code> attribute, it wouldn&#39;t be possible to refer to the root-level <code>name</code> property, because it would always resolve to the <code>name</code> property of the current post - and that&#39;s no good, because the root-level <code>name</code> property is used to construct the URL.</p>
<p>By using <code>../../name</code> instead of <code>name</code>, we&#39;re saying &#39;go up one level (to <code>posts</code>), then up one more (to the root), and <em>then</em> look for the <code>name</code> property&#39;.</p>
<h3 id="root-references">Root references</h3>
<p>You can also navigate directly from the top of the data hierarchy with <code>~/</code>. Note that this is the root of the ractive instance in which the template appears, not the entire view hierarchy of nested components.</p>
<p>The above example could also use a root reference:</p>
<pre><code class="language-html">&lt;h1&gt;Blog posts by {{name}}&lt;/p&gt;

&lt;ul class=&#39;blog-posts&#39;&gt;
  {{#posts}}
    &lt;li&gt;&lt;a href=&#39;{{ ~/name }}/{{ name }}&#39;&gt;{{name}}&lt;/a&gt;&lt;/li&gt;
  {{/posts}}
&lt;/ul&gt;</code></pre>
<h2 id="special-references">Special references</h2>
<p>There are a few things that can be useful to reference from the template that don&#39;t really exist in your data. For instance, the current iteration index of a repeated section. These special references can be used just like any other data reference, excepting two-way binding. Here&#39;s the list of specials and their resolutions:</p>
<ol>
<li><code>@index</code> - the current iteration index of the containing repeated section e.g. <code>{{#each list}}{{@index}}{{/each}}</code></li>
<li><code>@key</code> - the current key name of the containing object iteration section e.g. <code>{{#each someObj}}{{@key}}{{/each}}</code></li>
<li><code>@keypath</code> - the keypath to the current context e.g. <code>foo.bar.baz</code> in <code>{{#foo}}{{#with bar.baz}}{{@keypath}}{{/with}}{{/}}</code>. If the current context happens to be a mapping in a component, the keypath will be adjusted relative to the mapping.</li>
<li><code>@rootpath</code> - the same as keypath, except not adjusted for components.</li>
<li><code>@global</code> - the current global object for this environment e.g. <code>window</code> in a browser or <code>global</code> in node. This reference can be used with two-way binding, but note that if something outside of Ractive changes a value, Ractive won&#39;t know unless you tell it to <code>update</code>.</li>
<li><code>@this</code> - the current Ractive instance e.g. the current component or the Ractive root. You can access any properties or methods available on a Ractive instance with this, and due to the way capture works, you can also use <code>@this.get(&#39;...&#39;)</code> in a binding and it will update with the target keypath.</li>
</ol>
<h2 id="summary-of-prefixes">Summary of prefixes</h2>
<ul>
<li><code>~/</code> means at the current instance root.</li>
<li><code>.</code> means the current context. When more path follows, it follows the path from the current context.</li>
<li><code>../</code> means the parent of the current context and may also be stacked and have a following path.</li>
<li><code>@</code> means this is a special reference that has meaning specified by where it exists in the template e.g. <code>@index</code> means the current iteration index of the containing repeated section.</li>
</ul>

		</div>

		<aside class="left-nav">
			<section>
	<h1>Specific versions</h1>

	<ul>
		<li><a href='../0.8'>0.8</a></li>
		<li><a href='../0.7'>0.7</a></li>
		<li><a href='../0.6'>0.6</a></li>
		<li><a href='../0.5'>0.5</a></li>
		<li><a href='../0.4.0'>0.4.0</a></li>
		<li><a href='../0.3.9'>0.3.9</a></li>
	</ul>
</section>

<section>
	<h1>Introduction</h1>
	<ul>
		<li><a href="get-started">Get started</a></li>
		<li><a href="overview">Overview</a></li>
		<li><a href="known-issues-faqs-and-tips">Known issues, FAQs, and Tips</a></li>
		<li><a href="get-support">Get support</a></li>
		<li><a href="contributing">Contributing</a></li>
		<li><a href="get-started-with-node-js">Get started with node.js</a></li>
		<li><a href="migrating">Migrating from previous versions</a></li>
	</ul>
</section>

<section>
	<h1>Configuration</h1>
	<ul>
		<li><a href="options">Options</a></li>
		<li><a href="ractive-defaults">Defaults</a></li>
		<li><a href="advanced-configuration">Advanced configuration</a></li>
	</ul>
</section>
<section>
	<h1>Core Concepts</h1>
	<h2>Templates</h2>
	<ul>
		<li><a href="templates">Templates</a></li>
		<li><a href="elements">Elements</a></li>
		<li><a href="mustaches">Mustaches</a></li>
		<li><a href="references">References</a></li>
		<li><a href="expressions">Expressions</a></li>
		<li><a href="keypaths">Keypaths</a></li>
		<li><a href="partials">Partials</a></li>
		<li><a href="decorators">Decorators</a></li>
	</ul>
	<h2>Data & Binding</h2>
	<ul>
		<li><a href="two-way-binding">Two-way binding</a></li>
		<li><a href="magic-mode">Magic mode</a></li>
		<li><a href="dependants">Dependants</a></li>
		<li><a href="array-modification">Array modification</a></li>
		<li><a href="computed-properties">Computed Properties</a></li>
		<li><a href="observers">Observers</a></li>
		<li><a href="adaptors">Adaptors</a></li>
		<li><a href="parallel-dom">Parallel DOM</a></li>
	</ul>
	<h2>Events</h2>
	<ul>
		<li><a href="events-overview">Overview</a></li>
		<li><a href="event-directives">Event directives</a></li>
		<li><a href="proxy-events">Proxy events</a></li>
		<li><a href="method-calls">Method calls</a></li>
		<li><a href="publish-subscribe">Publish/subscribe</a></li>
		<li><a href="event-bubbling">Event bubbling</a></li>
		<li><a href="lifecycle-events">Lifecycle events</a></li>
	</ul>
	<h2>Transitions and Animations</h2>
	<ul>
		<li><a href="transitions">Transitions</a></li>
		<li><a href="promises">Promises</a></li>
		<li><a href="ractive-easing">Easings</a></li>
	</ul>
	<h2>Components</h2>
	<ul>
		<li><a href="components">Components</a></li>
	</ul>
</section>
<section>
	<h1>API Reference</h1>
	<h2>Constructor</h2>
	<ul>
		<li><a href="new-ractive">new Ractive(...)</a></li>
	</ul>
	<h2>Instance methods</h2>
	<ul>
		<li><a href="ractive-add">ractive.add()</a></li>
		<li><a href="ractive-animate">ractive.animate()</a></li>
		<li><a href="ractive-detach">ractive.detach()</a></li>
		<li><a href="ractive-find">ractive.find()</a></li>
		<li><a href="ractive-findall">ractive.findAll()</a></li>
		<li><a href="ractive-findallcomponents">ractive.findAllComponents()</a></li>
		<li><a href="ractive-findcomponent">ractive.findComponent()</a></li>
		<li><a href="ractive-findcontainer">ractive.findContainer()</a></li>
		<li><a href="ractive-findparent">ractive.findParent()</a></li>
		<li><a href="ractive-fire">ractive.fire()</a></li>
		<li><a href="ractive-get">ractive.get()</a></li>
		<li><a href="instance-getnodeinfo">ractive.getNodeInfo()</a></li>
		<li><a href="ractive-insert">ractive.insert()</a></li>
		<li><a href="ractive-link">ractive.link()</a></li>
		<li><a href="ractive-merge">ractive.merge()</a></li>
		<li><a href="ractive-observe">ractive.observe()</a></li>
		<li><a href="ractive-observeonce">ractive.observeOnce()</a></li>
		<li><a href="ractive-off">ractive.off()</a></li>
		<li><a href="ractive-on">ractive.on()</a></li>
		<li><a href="ractive-once">ractive.once()</a></li>
		<li><a href="ractive-pop">ractive.pop()</a></li>
		<li><a href="ractive-push">ractive.push()</a></li>
		<li><a href="ractive-render">ractive.render()</a></li>
		<li><a href="ractive-reset">ractive.reset()</a></li>
		<li><a href="ractive-resetpartial">ractive.resetPartial()</a></li>
		<li><a href="ractive-reverse">ractive.reverse()</a></li>
		<li><a href="ractive-set">ractive.set()</a></li>
		<li><a href="ractive-shift">ractive.shift()</a></li>
		<li><a href="ractive-sort">ractive.sort()</a></li>
		<li><a href="ractive-splice">ractive.splice()</a></li>
		<li><a href="ractive-subtract">ractive.subtract()</a></li>
		<li><a href="ractive-teardown">ractive.teardown()</a></li>
		<li><a href="ractive-tocss">ractive.toCSS()</a></li>
		<li><a href="ractive-toggle">ractive.toggle()</a></li>
		<li><a href="ractive-tohtml">ractive.toHTML()</a></li>
		<li><a href="ractive-transition">ractive.transition()</a></li>
		<li><a href="ractive-unlink">ractive.unlink()</a></li>
		<li><a href="ractive-unrender">ractive.unrender()</a></li>
		<li><a href="ractive-unshift">ractive.unshift()</a></li>
		<li><a href="ractive-update">ractive.update()</a></li>
		<li><a href="ractive-updatemodel">ractive.updateModel()</a></li>
	</ul>
	<h2>Instance properties</h2>
	<ul>
		<li><a href="ractive-container">ractive.container</a></li>
		<li><a href="ractive-nodes">ractive.nodes</a></li>
		<li><a href="ractive-transitions-instance">ractive.transitions</a></li>
		<li><a href="ractive-parent">ractive.parent</a></li>
		<li><a href="ractive-partials-instance">ractive.partials</a></li>
		<li><a href="ractive-root">ractive.root</a></li>
	</ul>
	<h2>Static methods</h2>
	<ul>
		<li><a href="ractive-escapekey">Ractive.escapeKey()</a></li>
		<li><a href="ractive-extend">Ractive.extend()</a></li>
		<li><a href="ractive-getcss">Ractive.getCSS()</a></li>
		<li><a href="ractive-getnodeinfo">Ractive.getNodeInfo()</a></li>
		<li><a href="ractive-joinkeys">Ractive.joinKeys()</a></li>
		<li><a href="ractive-parse">Ractive.parse()</a></li>
		<li><a href="ractive-splitkeypath">Ractive.splitKeypath()</a></li>
		<li><a href="ractive-unescapekey">Ractive.unescapeKey()</a></li>
	</ul>
	<h2>Static properties</h2>
	<ul>
		<li><a href="ractive-defaults">Ractive.defaults</a></li>
		<li><a href="ractive-easing">Ractive.easing</a></li>
	</ul>
</ul>
</section>
<section>
	<h1>Plugins</h1>
	<h2>Using</h2>
	<ul>
		<li><a href="plugins">List of plugins</a></li>
	</ul>
	<h2>Writing</h2>
	<ul>
		<li><a href="writing-adaptor-plugins">Adaptors</a></li>
		<li><a href="writing-decorator-plugins">Decorators</a></li>
		<li><a href="writing-event-plugins">Events</a></li>
		<li><a href="writing-transition-plugins">Transitions</a></li>
	</ul>
</section>



		</aside>
	</main>

	<footer>
	<p>Ractive.js is a free and open source project released under the MIT license.</p>
</footer>


	<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-5602942-6', 'ractivejs.org');
	ga('send', 'pageview');
</script>


	<script src='../assets/nav.js'></script>

</body>
</html>
